def versionUpCurrentScript():
    """Standalone menu entry for versioning up current open script."""
    from PySide2.QtWidgets import QMessageBox
    script_path = nuke.root().name()

    if not script_path or not os.path.exists(script_path):
        QMessageBox.warning(None, "No Script Found", "No valid script to version up.")
        return

    folder = os.path.dirname(script_path)
    base = os.path.basename(script_path)

    if "_v" not in base:
        QMessageBox.warning(None, "Bad Naming", f"Script name does not contain '_v': {base}")
        return

    prefix, ver_ext = base.rsplit("_v", 1)
    try:
        ver_num, ext = ver_ext.split(".", 1)
    except ValueError:
        QMessageBox.warning(None, "Bad Naming", f"Script name format not recognized: {base}")
        return

    new_ver = str(int(ver_num) + 1).zfill(3)
    new_name = f"{prefix}_v{new_ver}.{ext}"
    new_path = os.path.join(folder, new_name)

    nuke.scriptSaveAs(new_path)

    # Update Write nodes
    for node in nuke.allNodes("Write"):
        file_knob = node.knob("file").value()
        if "_v" in file_knob:
            file_prefix, file_ver_ext = file_knob.rsplit("_v", 1)
            try:
                _, file_ext = file_ver_ext.split(".", 1)
                node.knob("file").setValue(f"{file_prefix}_v{new_ver}.{file_ext}")
            except:
                pass

    nuke.message(f"Script versioned up to:\n{new_name}")

# Register menu
nuke.menu("Nuke").addCommand("Scripts/Version Up", versionUpCurrentScript, "Ctrl+Alt+V")
